@model InvoiceAutomation.Core.DTOs.Vendor.VendorDetailsDto
@{
    ViewData["Title"] = "Vendor Details";
    var companyId = (Guid)ViewBag.CompanyId;
    var companyName = (string)ViewBag.CompanyName;
}

<div class="container animate-fadeIn">
    <!-- Breadcrumbs -->
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a asp-controller="Company" asp-action="Details" asp-route-id="@companyId">
                    <i class="bi bi-building"></i> @companyName
                </a>
            </li>
            <li class="breadcrumb-item">
                <a asp-action="Index" asp-route-companyId="@companyId">Vendors</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">@Model.Name</li>
        </ol>
    </nav>

    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="page-header">
                <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
                    <div>
                        <div class="d-flex align-items-center gap-3 mb-2">
                            <div class="vendor-icon">
                                <i class="bi bi-truck"></i>
                            </div>
                            <div>
                                <h2 class="fw-bold mb-1">@Model.Name</h2>
                                <div class="d-flex gap-2 align-items-center">
                                    <span class="badge bg-info">@Model.Type</span>
                                    @if (Model.IsActive)
                                    {
                                        <span class="badge bg-success">
                                            <i class="bi bi-check-circle"></i> Active
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-secondary">
                                            <i class="bi bi-x-circle"></i> Inactive
                                        </span>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <a asp-action="Templates" asp-route-id="@Model.Id" asp-route-companyId="@companyId" class="btn btn-outline-info">
                            <i class="bi bi-file-earmark-ruled"></i> Invoice Templates
                        </a>
                        <a asp-action="Edit" asp-route-id="@Model.Id" asp-route-companyId="@companyId" class="btn btn-primary">
                            <i class="bi bi-pencil"></i> Edit
                        </a>
                        <a asp-action="Index" asp-route-companyId="@companyId" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left"></i> Back
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle"></i> @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- Main Content -->
    <div class="row g-4">
        <!-- Left Column - Information -->
        <div class="col-lg-8">
            <!-- Basic Information -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-info-circle"></i>
                        <span>Basic Information</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Email</span>
                                <span class="info-value">
                                    @if (!string.IsNullOrEmpty(Model.Email))
                                    {
                                        <a href="mailto:@Model.Email">@Model.Email</a>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not provided</span>
                                    }
                                </span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Phone</span>
                                <span class="info-value">
                                    @if (!string.IsNullOrEmpty(Model.Phone))
                                    {
                                        <a href="tel:@Model.Phone">@Model.Phone</a>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not provided</span>
                                    }
                                </span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Mobile Phone</span>
                                <span class="info-value">
                                    @if (!string.IsNullOrEmpty(Model.MobilePhone))
                                    {
                                        <a href="tel:@Model.MobilePhone">@Model.MobilePhone</a>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not provided</span>
                                    }
                                </span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Website</span>
                                <span class="info-value">
                                    @if (!string.IsNullOrEmpty(Model.Website))
                                    {
                                        <a href="@Model.Website" target="_blank">@Model.Website <i class="bi bi-box-arrow-up-right small"></i></a>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not provided</span>
                                    }
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tax Information -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-file-text"></i>
                        <span>Tax Information</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">NTN</span>
                                <span class="info-value fw-bold">@Model.Ntn</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">STRN</span>
                                <span class="info-value">@(Model.Strn ?? "N/A")</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">Registration #</span>
                                <span class="info-value">@(Model.RegistrationNumber ?? "N/A")</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Address -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-geo-alt"></i>
                        <span>Address</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-12">
                            <div class="info-row">
                                <span class="info-label">Street Address</span>
                                <span class="info-value">@Model.Address</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">City</span>
                                <span class="info-value">@Model.City</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">State/Province</span>
                                <span class="info-value">@Model.State</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">Postal Code</span>
                                <span class="info-value">@(Model.PostalCode ?? "N/A")</span>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="info-row">
                                <span class="info-label">Country</span>
                                <span class="info-value">@Model.Country</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Person -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-person"></i>
                        <span>Contact Person</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">Name</span>
                                <span class="info-value fw-bold">@Model.ContactPersonName</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">Email</span>
                                <span class="info-value">
                                    @if (!string.IsNullOrEmpty(Model.ContactPersonEmail))
                                    {
                                        <a href="mailto:@Model.ContactPersonEmail">@Model.ContactPersonEmail</a>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not provided</span>
                                    }
                                </span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="info-row">
                                <span class="info-label">Phone</span>
                                <span class="info-value">
                                    <a href="tel:@Model.ContactPersonPhone">@Model.ContactPersonPhone</a>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Banking Information -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-bank"></i>
                        <span>Banking Information</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Bank Name</span>
                                <span class="info-value fw-bold">@Model.BankName</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Account Title</span>
                                <span class="info-value">@Model.BankAccountTitle</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Account Number</span>
                                <span class="info-value font-monospace">@Model.BankAccountNumber</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">IBAN</span>
                                <span class="info-value font-monospace">@Model.Iban</span>
                            </div>
                        </div>
                        @if (!string.IsNullOrEmpty(Model.SwiftCode))
                        {
                            <div class="col-md-6">
                                <div class="info-row">
                                    <span class="info-label">SWIFT Code</span>
                                    <span class="info-value font-monospace">@Model.SwiftCode</span>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Payment Terms -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="info-section-title mb-3">
                        <i class="bi bi-calendar-check"></i>
                        <span>Payment Terms</span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">Payment Terms</span>
                                <span class="info-value">
                                    @if (Model.PaymentTermDays.HasValue)
                                    {
                                        <span class="badge bg-primary">@Model.PaymentTermDays days</span>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not specified</span>
                                    }
                                </span>
                            </div>
                        </div>
                        @if (!string.IsNullOrEmpty(Model.PaymentTermsNotes))
                        {
                            <div class="col-12">
                                <div class="info-row">
                                    <span class="info-label">Notes</span>
                                    <span class="info-value">@Model.PaymentTermsNotes</span>
                                </div>
                            </div>
                        }
                        @if (!string.IsNullOrEmpty(Model.Notes))
                        {
                            <div class="col-12">
                                <div class="info-row">
                                    <span class="info-label">Additional Notes</span>
                                    <span class="info-value">@Model.Notes</span>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column - Actions & Metadata -->
        <div class="col-lg-4">
            <!-- Actions Card -->
            <div class="action-card mb-4">
                <h5>
                    <i class="bi bi-gear"></i>
                    Actions
                </h5>
                <div class="d-grid gap-2">
                    @if (Model.IsActive)
                    {
                        <form asp-action="Deactivate" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-warning w-100" onclick="return confirm('Are you sure you want to deactivate this vendor?')">
                                <i class="bi bi-pause-circle"></i> Deactivate Vendor
                            </button>
                        </form>
                    }
                    else
                    {
                        <form asp-action="Activate" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-success w-100">
                                <i class="bi bi-play-circle"></i> Activate Vendor
                            </button>
                        </form>
                    }
                    <hr />
                    <form asp-action="Delete" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post" onsubmit="return confirm('Are you sure you want to delete this vendor? This action cannot be undone.')">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-danger w-100">
                            <i class="bi bi-trash"></i> Delete Vendor
                        </button>
                    </form>
                </div>
            </div>

            <!-- Metadata Card -->
            <div class="card">
                <div class="card-body">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-info-circle me-2"></i>Metadata
                    </h6>
                    <div class="info-row">
                        <span class="info-label">Created</span>
                        <span class="info-value">@Model.CreatedAt.ToString("MMM dd, yyyy")</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">@Model.UpdatedAt.ToString("MMM dd, yyyy")</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Created By</span>
                        <span class="info-value">@Model.CreatedByName</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .vendor-icon {
        width: 60px;
        height: 60px;
        border-radius: var(--radius-xl);
        background: var(--primary-gradient);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.75rem;
        box-shadow: var(--shadow-md);
    }

    .info-row {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        padding: 0.75rem 0;
    }

    .info-row:not(:last-child) {
        border-bottom: 1px solid var(--border-color);
    }

    .info-label {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--text-tertiary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .info-value {
        font-size: 0.9375rem;
        color: var(--text-primary);
    }

    .info-value a {
        color: var(--primary-color);
        text-decoration: none;
    }

    .info-value a:hover {
        text-decoration: underline;
    }
</style>
