@model InvoiceAutomation.Core.DTOs.Vendor.VendorDetailsDto
@{
    ViewData["Title"] = "Vendor Details";
    var companyId = (Guid)ViewBag.CompanyId;
    var companyName = (string)ViewBag.CompanyName;
}

<!-- Breadcrumbs -->
<nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a asp-controller="Company" asp-action="Details" asp-route-id="@companyId">
                <i class="bi bi-building"></i> @companyName
            </a>
        </li>
        <li class="breadcrumb-item">
            <a asp-action="Index" asp-route-companyId="@companyId">Vendors</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">@Model.Name</li>
    </ol>
</nav>

<!-- Page Header -->
<div class="page-header mb-4">
    <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
        <div class="d-flex align-items-center gap-3">
            <div class="rounded-3 p-3 d-flex align-items-center justify-content-center" style="width: 56px; height: 56px; background-color: #eff6ff;">
                <i class="bi bi-truck" style="font-size: 1.5rem; color: #2563eb;"></i>
            </div>
            <div>
                <h2 class="fw-bold mb-1">@Model.Name</h2>
                <div class="d-flex gap-2 align-items-center">
                    <span class="badge bg-info-subtle text-info-emphasis">@Model.Type</span>
                    @if (Model.IsActive)
                    {
                        <span class="badge bg-success-subtle text-success-emphasis">Active</span>
                    }
                    else
                    {
                        <span class="badge bg-secondary-subtle text-secondary-emphasis">Inactive</span>
                    }
                </div>
            </div>
        </div>
        <div class="d-flex gap-2">
            <a asp-action="Templates" asp-route-id="@Model.Id" asp-route-companyId="@companyId" class="btn btn-outline-primary">
                <i class="bi bi-file-earmark-ruled me-1"></i> Invoice Templates
            </a>
            <a asp-action="Edit" asp-route-id="@Model.Id" asp-route-companyId="@companyId" class="btn btn-primary">
                <i class="bi bi-pencil me-1"></i> Edit
            </a>
            <a asp-action="Index" asp-route-companyId="@companyId" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-1"></i> Back
            </a>
        </div>
    </div>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="bi bi-check-circle me-1"></i> @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<!-- Main Content -->
<div class="row g-4">
    <!-- Left Column -->
    <div class="col-lg-8">
        <!-- Basic Information -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Basic Information</h6>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Email</span>
                            <span class="info-value">
                                @if (!string.IsNullOrEmpty(Model.Email))
                                {
                                    <a href="mailto:@Model.Email" class="text-decoration-none">@Model.Email</a>
                                }
                                else
                                {
                                    <span class="text-muted">Not provided</span>
                                }
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Phone</span>
                            <span class="info-value">
                                @if (!string.IsNullOrEmpty(Model.Phone))
                                {
                                    <a href="tel:@Model.Phone" class="text-decoration-none">@Model.Phone</a>
                                }
                                else
                                {
                                    <span class="text-muted">Not provided</span>
                                }
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Mobile Phone</span>
                            <span class="info-value">
                                @if (!string.IsNullOrEmpty(Model.MobilePhone))
                                {
                                    <a href="tel:@Model.MobilePhone" class="text-decoration-none">@Model.MobilePhone</a>
                                }
                                else
                                {
                                    <span class="text-muted">Not provided</span>
                                }
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Website</span>
                            <span class="info-value">
                                @if (!string.IsNullOrEmpty(Model.Website))
                                {
                                    <a href="@Model.Website" target="_blank" class="text-decoration-none">@Model.Website <i class="bi bi-box-arrow-up-right small"></i></a>
                                }
                                else
                                {
                                    <span class="text-muted">Not provided</span>
                                }
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tax Information -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Tax Information</h6>
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">NTN</span>
                            <span class="info-value fw-semibold">@Model.Ntn</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">STRN</span>
                            <span class="info-value">@(Model.Strn ?? "N/A")</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">Registration #</span>
                            <span class="info-value">@(Model.RegistrationNumber ?? "N/A")</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Address -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Address</h6>
                <div class="row g-3">
                    <div class="col-12">
                        <div class="info-row">
                            <span class="info-label">Street Address</span>
                            <span class="info-value">@Model.Address</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">City</span>
                            <span class="info-value">@Model.City</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">State/Province</span>
                            <span class="info-value">@Model.State</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">Postal Code</span>
                            <span class="info-value">@(Model.PostalCode ?? "N/A")</span>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="info-row">
                            <span class="info-label">Country</span>
                            <span class="info-value">@Model.Country</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Person -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Contact Person</h6>
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">Name</span>
                            <span class="info-value fw-semibold">@Model.ContactPersonName</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">Email</span>
                            <span class="info-value">
                                @if (!string.IsNullOrEmpty(Model.ContactPersonEmail))
                                {
                                    <a href="mailto:@Model.ContactPersonEmail" class="text-decoration-none">@Model.ContactPersonEmail</a>
                                }
                                else
                                {
                                    <span class="text-muted">Not provided</span>
                                }
                            </span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="info-row">
                            <span class="info-label">Phone</span>
                            <span class="info-value">
                                <a href="tel:@Model.ContactPersonPhone" class="text-decoration-none">@Model.ContactPersonPhone</a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Banking Information -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Banking Information</h6>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Bank Name</span>
                            <span class="info-value fw-semibold">@Model.BankName</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Account Title</span>
                            <span class="info-value">@Model.BankAccountTitle</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Account Number</span>
                            <span class="info-value font-monospace">@Model.BankAccountNumber</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">IBAN</span>
                            <span class="info-value font-monospace">@Model.Iban</span>
                        </div>
                    </div>
                    @if (!string.IsNullOrEmpty(Model.SwiftCode))
                    {
                        <div class="col-md-6">
                            <div class="info-row">
                                <span class="info-label">SWIFT Code</span>
                                <span class="info-value font-monospace">@Model.SwiftCode</span>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Payment Terms -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold text-muted text-uppercase small mb-3">Payment Terms</h6>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="info-row">
                            <span class="info-label">Payment Terms</span>
                            <span class="info-value">
                                @if (Model.PaymentTermDays.HasValue)
                                {
                                    <span class="badge" style="background-color: #2563eb;">@Model.PaymentTermDays days</span>
                                }
                                else
                                {
                                    <span class="text-muted">Not specified</span>
                                }
                            </span>
                        </div>
                    </div>
                    @if (!string.IsNullOrEmpty(Model.PaymentTermsNotes))
                    {
                        <div class="col-12">
                            <div class="info-row">
                                <span class="info-label">Notes</span>
                                <span class="info-value">@Model.PaymentTermsNotes</span>
                            </div>
                        </div>
                    }
                    @if (!string.IsNullOrEmpty(Model.Notes))
                    {
                        <div class="col-12">
                            <div class="info-row">
                                <span class="info-label">Additional Notes</span>
                                <span class="info-value">@Model.Notes</span>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Right Column -->
    <div class="col-lg-4">
        <!-- Actions Card -->
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="fw-semibold mb-3">Actions</h6>
                <div class="d-grid gap-2">
                    @if (Model.IsActive)
                    {
                        <form asp-action="Deactivate" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-warning w-100" onclick="return confirm('Are you sure you want to deactivate this vendor?')">
                                <i class="bi bi-pause-circle me-1"></i> Deactivate Vendor
                            </button>
                        </form>
                    }
                    else
                    {
                        <form asp-action="Activate" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-success w-100">
                                <i class="bi bi-play-circle me-1"></i> Activate Vendor
                            </button>
                        </form>
                    }
                    <hr />
                    <form asp-action="Delete" asp-route-id="@Model.Id" asp-route-companyId="@companyId" method="post" onsubmit="return confirm('Are you sure you want to delete this vendor? This action cannot be undone.')">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-danger w-100">
                            <i class="bi bi-trash me-1"></i> Delete Vendor
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Metadata Card -->
        <div class="card">
            <div class="card-body">
                <h6 class="fw-semibold mb-3">Metadata</h6>
                <div class="info-row">
                    <span class="info-label">Created</span>
                    <span class="info-value">@Model.CreatedAt.ToString("MMM dd, yyyy")</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Last Updated</span>
                    <span class="info-value">@Model.UpdatedAt.ToString("MMM dd, yyyy")</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Created By</span>
                    <span class="info-value">@Model.CreatedByName</span>
                </div>
            </div>
        </div>
    </div>
</div>
